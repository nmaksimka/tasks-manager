<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title th:text="${isEdit} ? '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏' : '–ù–æ–≤–∞—è –∑–∞–¥–∞—á–∞'">Task Manager</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link th:href="@{/css/style.css}" rel="stylesheet">
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-dark bg-primary">
    <div class="container">
        <a class="navbar-brand" href="/">‚úÖ Task Manager</a>
        <div class="navbar-nav">
            <a class="nav-link" href="/">‚Üê –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É</a>
        </div>
    </div>
</nav>

<div class="container mt-4">
    <div class="row justify-content-center">
        <div class="col-md-8 col-lg-6">
            <div class="card shadow">
                <div class="card-header bg-primary text-white">
                    <h4 class="mb-0">
                        <span th:if="${isEdit}">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏</span>
                        <span th:unless="${isEdit}">‚ûï –ù–æ–≤–∞—è –∑–∞–¥–∞—á–∞</span>
                    </h4>
                </div>
                <div class="card-body">
                    <form th:action="@{/tasks/save}" method="post" th:object="${task}">
                        <input type="hidden" name="id" th:value="*{id}"/>

                        <div class="mb-3">
                            <label for="title" class="form-label fw-bold">–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ *</label>
                            <input type="text" class="form-control form-control-lg"
                                   id="title" th:field="*{title}"
                                   placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏" required>
                            <div class="form-text">–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ, –æ—Ç 3 –¥–æ 100 —Å–∏–º–≤–æ–ª–æ–≤</div>
                        </div>

                        <div class="mb-3">
                            <label for="description" class="form-label fw-bold">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                            <textarea class="form-control" id="description"
                                      th:field="*{description}" rows="4"
                                      placeholder="–û–ø–∏—à–∏—Ç–µ –¥–µ—Ç–∞–ª–∏ –∑–∞–¥–∞—á–∏ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)"></textarea>
                            <div class="form-text">–ú–∞–∫—Å–∏–º—É–º 777 —Å–∏–º–≤–æ–ª–æ–≤</div>
                        </div>

                        <div class="mb-4">
                            <label class="form-label fw-bold d-block mb-3">–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç</label>
                            <div class="row g-3">
                                <div class="col-4">
                                    <div class="card priority-option text-center p-3"
                                         onclick="selectPriority(1)"
                                         th:classappend="${task.priority == 1} ? 'selected' : ''">
                                        <div class="text-danger fs-5">üî¥</div>
                                        <div class="fw-bold text-danger">–í—ã—Å–æ–∫–∏–π</div>
                                        <small class="text-muted">–°—Ä–æ—á–Ω–æ –≤–∞–∂–Ω–æ</small>
                                    </div>
                                </div>
                                <div class="col-4">
                                    <div class="card priority-option text-center p-3"
                                         onclick="selectPriority(2)"
                                         th:classappend="${task.priority == 2 or task.priority == null} ? 'selected' : ''">
                                        <div class="text-warning fs-5">üü°</div>
                                        <div class="fw-bold text-warning">–°—Ä–µ–¥–Ω–∏–π</div>
                                        <small class="text-muted">–û–±—ã—á–Ω–∞—è –≤–∞–∂–Ω–æ—Å—Ç—å</small>
                                    </div>
                                </div>
                                <div class="col-4">
                                    <div class="card priority-option text-center p-3"
                                         onclick="selectPriority(3)"
                                         th:classappend="${task.priority == 3} ? 'selected' : ''">
                                        <div class="text-success fs-5">üü¢</div>
                                        <div class="fw-bold text-success">–ù–∏–∑–∫–∏–π</div>
                                        <small class="text-muted">–ù–µ —Å—Ä–æ—á–Ω–æ</small>
                                    </div>
                                </div>
                            </div>
                            <input type="hidden" id="priority" th:field="*{priority}" value="2">
                        </div>
                        <div class="mb-4">
                            <label for="deadline" class="form-label fw-bold">–î–µ–¥–ª–∞–π–Ω</label>
                            <input type="date" class="form-control"
                                   id="deadline" th:field="*{deadline}">
                            <div class="form-text">–£–∫–∞–∂–∏—Ç–µ –¥–∞—Ç—É, –¥–æ –∫–æ—Ç–æ—Ä–æ–π –Ω—É–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∑–∞–¥–∞—á—É (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</div>
                        </div>

                        <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                            <a href="/" class="btn btn-outline-secondary me-md-2 px-4">
                                –û—Ç–º–µ–Ω–∞
                            </a>
                            <button type="submit" class="btn btn-primary px-4">
                                <span th:if="${isEdit}">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</span>
                                <span th:unless="${isEdit}">–°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É</span>
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <div class="mt-4 text-center text-muted">
                <small>
                    <span th:if="${isEdit}">–ò–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—Ç—Å—è –º–æ–º–µ–Ω—Ç–∞–ª—å–Ω–æ</span>
                    <span th:unless="${isEdit}">–ó–∞–¥–∞—á–∞ –ø–æ—è–≤–∏—Ç—Å—è –≤ –æ–±—â–µ–º —Å–ø–∏—Å–∫–µ</span>
                </small>
            </div>
        </div>
    </div>
</div>

<script>
    function selectPriority(priority) {
        document.getElementById('priority').value = priority;

        document.querySelectorAll('.priority-option').forEach(el => {
            el.classList.remove('selected');
        });

        event.currentTarget.classList.add('selected');
    }
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>